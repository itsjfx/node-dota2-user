#!/usr/bin/env bash
set -eu -o pipefail

cd "$(dirname "$0")/../"

# TODO: xargs
for file in ./protobufs/*.proto; do
    protoc \
        --proto_path=./protobufs \
        --plugin=./node_modules/.bin/protoc-gen-ts_proto \
        --ts_proto_out=src/protobufs/ \
        --ts_proto_opt=outputServices=generic-definitions,outputServices=default,env=node,outputSchema=true,esModuleInterop=true,forceLong=string \
        "$file"
done
